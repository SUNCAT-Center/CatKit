<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2018-06-02 Sat 20:10 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>CatGen: Catalysis Generator</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Jacob Boes" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="https://www.pirilampo.org/styles/readtheorg/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="https://www.pirilampo.org/styles/readtheorg/css/readtheorg.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://www.pirilampo.org/styles/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="https://www.pirilampo.org/styles/readtheorg/js/readtheorg.js"></script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2017 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">CatGen: Catalysis Generator</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org0e3e58d">1. Enumerations</a>
<ul>
<li><a href="#orgf692752">1.1. Surface module:</a>
<ul>
<li><a href="#org30991cf">1.1.1. Slab enumeration:</a></li>
<li><a href="#org93a4d12">1.1.2. Slab graph and surface atoms:</a></li>
<li><a href="#orgdc5dd3c">1.1.3. Simple site enumeration:</a></li>
</ul>
</li>
<li><a href="#orgbf84bf1">1.2. Adsorption module</a>
<ul>
<li><a href="#org06e25a4">1.2.1. ``Manual'' Adsorption site enumeration and visualization:</a></li>
<li><a href="#org9ce6f58">1.2.2. Extended site enumeration:</a></li>
<li><a href="#orge7728b9">1.2.3. Adsorption vectors</a></li>
<li><a href="#orgd415e03">1.2.4. Adsorption structure builder</a></li>
</ul>
</li>
<li><a href="#org24eeb02">1.3. Gas-phase:</a>
<ul>
<li><a href="#orgb177929">1.3.1. Example usage:</a></li>
</ul>
</li>
<li><a href="#orgf0caef0">1.4. Reaction mechanisms:</a>
<ul>
<li><a href="#org3cd1734">1.4.1. Reaction networks:</a></li>
</ul>
</li>
<li><a href="#org50cf3ef">1.5. Reaction routes</a>
<ul>
<li><a href="#org1f6c48b">1.5.1. Overall/Response reaction routes</a></li>
<li><a href="#org2e49186">1.5.2. Linearly independent set</a></li>
<li><a href="#orgd52d961">1.5.3. Complete full and empty enumeration</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<p>
Currently, the primary function of CatGen is for automated enumeration of various systems of atoms and other catalytically relevant properties. This is performed through symmetries which exist in these chemical systems. These symmetries take the form of translations and rotations in bulk structures where well defined lattices exist. For gas-phase, symmetries are defined through bonds formation rules.
</p>

<p>
By conserving bond-formation order and pairing it with bulk symmetry enumerations, a comprehensive mapping tools of all possible relevant chemical pathways can be produced. This information can then be aggregated and used to gain insights into catalytic systems.
</p>

<p>
Current enumerations include:
</p>

<ul class="org-ul">
<li class="on"><code>[X]</code> Surfaces structures</li>
<li class="on"><code>[X]</code> Adsorption sites</li>
<li class="on"><code>[X]</code> Catalytic structures</li>
<li class="on"><code>[X]</code> Gas phase molecules</li>
<li class="on"><code>[X]</code> Reaction mechanisms</li>
<li class="on"><code>[X]</code> Reaction routes</li>
</ul>

<div id="outline-container-org0e3e58d" class="outline-2">
<h2 id="org0e3e58d"><span class="section-number-2">1</span> Enumerations</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-orgf692752" class="outline-3">
<h3 id="orgf692752"><span class="section-number-3">1.1</span> Surface module:</h3>
<div class="outline-text-3" id="text-1-1">
<p>
The surface module is designed to leverage information about the bulk structure which a slab is derived from.
</p>

<ul class="org-ul">
<li class="on"><code>[X]</code> Surfaces produced from all user defined bulk lattices</li>
<li class="on"><code>[X]</code> Any miller indices</li>
<li class="on"><code>[X]</code> Unique terminations of possible surfaces</li>
<li class="on"><code>[X]</code> Surface atom identification</li>
<li class="on"><code>[X]</code> Voronoi connectivity of slab atoms</li>
<li class="on"><code>[X]</code> Enumerate surface adsorption sites</li>
</ul>
</div>

<div id="outline-container-org30991cf" class="outline-4">
<h4 id="org30991cf"><span class="section-number-4">1.1.1</span> Slab enumeration:</h4>
<div class="outline-text-4" id="text-1-1-1">
<p>
Example surface generation for the 2 terminations of a fcc(211) surface construction of an L1<sub>0</sub> CuPd<sub>3</sub> cubic alloy.
</p>

<p>
<img src="../CuPd3-term-0.png" alt="CuPd3-term-0.png" /> <img src="../CuPd3-term-0-top.png" alt="CuPd3-term-0-top.png" />
</p>

<p>
<img src="../CuPd3-term-1.png" alt="CuPd3-term-1.png" /> <img src="../CuPd3-term-1-top.png" alt="CuPd3-term-1-top.png" />
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #0000FF;">from</span> catkit.gen.surface <span style="color: #0000FF;">import</span> SlabGenerator
<span style="color: #0000FF;">from</span> ase.build <span style="color: #0000FF;">import</span> bulk
<span style="color: #0000FF;">from</span> ase.visualize <span style="color: #0000FF;">import</span> view

<span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Make a test slab</span>
<span style="color: #BA36A5;">atoms</span> = bulk(<span style="color: #008000;">'Pd'</span>, <span style="color: #008000;">'fcc'</span>, cubic=<span style="color: #D0372D;">True</span>)
atoms[3]<span style="color: #BA36A5;">.symbol</span> = <span style="color: #008000;">'Cu'</span>

<span style="color: #BA36A5;">gen</span> = SlabGenerator(
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   atoms,
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   miller_index=(2, 1, 1),
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   layers=9,
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   fixed=5,
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   vacuum=4)

<span style="color: #BA36A5;">terminations</span> = gen.get_unique_terminations()

<span style="color: #BA36A5;">images</span> = []
<span style="color: #0000FF;">for</span> i, t <span style="color: #0000FF;">in</span> <span style="color: #006FE0;">enumerate</span>(terminations):
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">images</span> += [gen.get_slab(iterm=i)]

view(images)
</pre>
</div>

<p>
For convenience, the <code>catkit.build</code> module has a surface constructor which takes any arguments for ASE's bulk generators as well as the SlabGenerator.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #0000FF;">from</span> catkit.build <span style="color: #0000FF;">import</span> surface
<span style="color: #0000FF;">from</span> ase.build <span style="color: #0000FF;">import</span> bulk

<span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Make a test slab</span>
<span style="color: #BA36A5;">atoms</span> = bulk(<span style="color: #008000;">'Pd'</span>, <span style="color: #008000;">'fcc'</span>, cubic=<span style="color: #D0372D;">True</span>)
atoms[3]<span style="color: #BA36A5;">.symbol</span> = <span style="color: #008000;">'Cu'</span>

<span style="color: #BA36A5;">slab</span> = surface(atoms,
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>  size=(1, 1, 9), miller=(2, 1, 1),
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>  vacuum=9, fixed=5)

slab.edit()
</pre>
</div>
</div>
</div>

<div id="outline-container-org93a4d12" class="outline-4">
<h4 id="org93a4d12"><span class="section-number-4">1.1.2</span> Slab graph and surface atoms:</h4>
<div class="outline-text-4" id="text-1-1-2">
<p>
One of the less visual features is the identification of the surface atoms and identification of nearest-neighbors which is subsequently used for creating graph edges. When performing more sophisticated operations, such as adsorption site identification, these functions are being called automatically.
</p>


<div class="figure">
<p><img src="../Pd-surface-atoms.png" alt="Pd-surface-atoms.png" />
</p>
<p><span class="figure-number">Figure 1: </span>Slab of hcp Pd with (110) miller index. Top surface atoms have been changed to Au.</p>
</div>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #0000FF;">from</span> catkit.build <span style="color: #0000FF;">import</span> surface
<span style="color: #0000FF;">from</span> ase.io <span style="color: #0000FF;">import</span> write

<span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Size is 3 layers and 3 times the unit area of the primitve cell</span>
<span style="color: #BA36A5;">atoms</span> = surface(<span style="color: #008000;">'Pd'</span>, size=(3, 3), miller=(1, 1, 1), vacuum=4)

<span style="color: #0000FF;">print</span>(atoms.connectivity)

<span style="color: #0000FF;">for</span> i <span style="color: #0000FF;">in</span> atoms.get_surface_atoms():
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   atoms[i]<span style="color: #BA36A5;">.symbol</span> = <span style="color: #008000;">'Au'</span>

atoms.edit()
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">3</td>
<td class="org-right">3</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-right">0</td>
<td class="org-right">3</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-right">3</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">3</td>
<td class="org-right">3</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">3</td>
<td class="org-right">0</td>
<td class="org-right">3</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">3</td>
<td class="org-right">3</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">3</td>
<td class="org-right">3</td>
</tr>

<tr>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">3</td>
<td class="org-right">0</td>
<td class="org-right">3</td>
</tr>

<tr>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">3</td>
<td class="org-right">3</td>
<td class="org-right">0</td>
</tr>
</tbody>
</table>

<p>
CatGen automatically attaches the connectivity matrix into a NetworkX graph and stores it in the Gratoms object for future use.
</p>
</div>
</div>

<div id="outline-container-orgdc5dd3c" class="outline-4">
<h4 id="orgdc5dd3c"><span class="section-number-4">1.1.3</span> Simple site enumeration:</h4>
<div class="outline-text-4" id="text-1-1-3">
<p>
With a generated slab, we can also produce the unique adsorption sites which would be present on a given surface.
</p>


<div class="figure">
<p><img src="../CuPd3_111-sites.png" alt="CuPd3_111-sites.png" />
</p>
<p><span class="figure-number">Figure 2: </span>Symmetry unique sites of CuPd<sub>3</sub> (111). Green denote 3-fold hollows, white are bridge, and red are top sites.</p>
</div>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #0000FF;">from</span> catkit.gen.surface <span style="color: #0000FF;">import</span> SlabGenerator
<span style="color: #0000FF;">from</span> ase.build <span style="color: #0000FF;">import</span> bulk
<span style="color: #0000FF;">from</span> ase <span style="color: #0000FF;">import</span> Atom

<span style="color: #BA36A5;">bulk</span> = bulk(<span style="color: #008000;">'Pd'</span>, <span style="color: #008000;">'fcc'</span>, a=5, cubic=<span style="color: #D0372D;">True</span>)
bulk[3]<span style="color: #BA36A5;">.symbol</span> = <span style="color: #008000;">'Cu'</span>

<span style="color: #BA36A5;">gen</span> = SlabGenerator(
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   bulk,
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   miller_index=(1, 1, 1),
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   layers=3,
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   vacuum=10)

<span style="color: #BA36A5;">atoms</span> = gen.get_slab()
<span style="color: #BA36A5;">coordinates</span>, <span style="color: #BA36A5;">connectivity</span> = gen.adsorption_sites(atoms)

<span style="color: #BA36A5;">atm</span> = {1: <span style="color: #008000;">'X'</span>, 2: <span style="color: #008000;">'He'</span>, 3: <span style="color: #008000;">'F'</span>}
<span style="color: #0000FF;">for</span> i, c <span style="color: #0000FF;">in</span> <span style="color: #006FE0;">enumerate</span>(coordinates):
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">typ</span> = connectivity[i]
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">atoms</span> += Atom(atm[typ], c + [0, 0, 2])

atoms.edit()
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgbf84bf1" class="outline-3">
<h3 id="orgbf84bf1"><span class="section-number-3">1.2</span> Adsorption module</h3>
<div class="outline-text-3" id="text-1-2">
<p>
Using the <code>AdsorptionSites</code> class form the adsorption module provides more powerful tools for surface site enumeration.
</p>

<ul class="org-ul">
<li class="on"><code>[X]</code> Adsorption site enumeration based on user defined surface atoms.</li>
<li class="on"><code>[X]</code> 1st and 2nd (rank) nearest neighbor topology of surface atoms.</li>
<li class="on"><code>[X]</code> Connectivity of adsorption site (hollow = 3, bridge = 2, top = 1)</li>
<li class="on"><code>[X]</code> 2D adsorption coordinates relative to miller index.</li>
<li class="on"><code>[X]</code> Adsorption vectors for accurate 3D projection.</li>
<li class="on"><code>[X]</code> Connectivity between adsorption sites</li>
</ul>
</div>

<div id="outline-container-org06e25a4" class="outline-4">
<h4 id="org06e25a4"><span class="section-number-4">1.2.1</span> ``Manual'' Adsorption site enumeration and visualization:</h4>
<div class="outline-text-4" id="text-1-2-1">
<p>
Adsorption site enumeration in CatGen is solely dependent upon surface atom identification. This is performed automatically using <code>catkit.gen.surface.SlabGenerator</code> or <code>catkit.build.surface</code>, however, this function relies upon bulk properties which are not always available.
</p>

<p>
Here, we show how the surface sites can be assigned manually which is often convenient enough.
</p>

<p>
Surface atoms are used to define top sites (green), which are then used to define remaining sites (red) via Delaunay triangulation symmetries.
</p>


<div class="figure">
<p><img src="../Pd3Cu-adsorption-sites.png" alt="Pd3Cu-adsorption-sites.png" />
</p>
<p><span class="figure-number">Figure 3: </span>Delaunay triangulation of surface atoms for fcc(111) structure.</p>
</div>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #0000FF;">from</span> catkit.gen.adsorption <span style="color: #0000FF;">import</span> AdsorptionSites
<span style="color: #0000FF;">from</span> catkit.gen.surface <span style="color: #0000FF;">import</span> SlabGenerator
<span style="color: #0000FF;">from</span> ase.build <span style="color: #0000FF;">import</span> bulk

<span style="color: #BA36A5;">bulk</span> = bulk(<span style="color: #008000;">'Pd'</span>, <span style="color: #008000;">'fcc'</span>, a=5, cubic=<span style="color: #D0372D;">True</span>)
bulk[3]<span style="color: #BA36A5;">.symbol</span> = <span style="color: #008000;">'Cu'</span>

<span style="color: #BA36A5;">gen</span> = SlabGenerator(
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   bulk,
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   miller_index=(1, 1, 1),
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   layers=3,
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   vacuum=4)

<span style="color: #BA36A5;">atoms</span> = gen.get_slab()
atoms.set_surface_atoms([8, 9, 10, 11])

<span style="color: #BA36A5;">sites</span> = AdsorptionSites(atoms)
sites.plot(<span style="color: #008000;">'./Pd3Cu-adsorption-sites.png'</span>)
</pre>
</div>
</div>
</div>

<div id="outline-container-org9ce6f58" class="outline-4">
<h4 id="org9ce6f58"><span class="section-number-4">1.2.2</span> Extended site enumeration:</h4>
<div class="outline-text-4" id="text-1-2-2">
<p>
For more complex adsorption enumeration, we often require more detailed information.
</p>

<p>
The <code>AdsorptionSite</code> class also produces an expanded unit cell which is useful for operations which require observation of periodic boundary conditions. This extended unit cell can be accessed by toggling the <code>screen</code> argument.
</p>

<p>
All possible adsorption sites of of CuPd<sub>3</sub> (321). Site identifications are the same as above with the addition of blue which shows 4-fold hollow sites.
</p>


<div class="figure">
<p><img src="../CuPd3_321-sites.png" alt="CuPd3_321-sites.png" />
</p>
<p><span class="figure-number">Figure 4: </span>Unique adsorption site enumeration for fcc(321) alloy.</p>
</div>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #0000FF;">from</span> catkit.gen.adsorption <span style="color: #0000FF;">import</span> AdsorptionSites
<span style="color: #0000FF;">from</span> catkit.gen.surface <span style="color: #0000FF;">import</span> SlabGenerator
<span style="color: #0000FF;">from</span> ase.build <span style="color: #0000FF;">import</span> bulk
<span style="color: #0000FF;">from</span> ase.io <span style="color: #0000FF;">import</span> write
<span style="color: #0000FF;">from</span> ase <span style="color: #0000FF;">import</span> Atom

<span style="color: #BA36A5;">bulk</span> = bulk(<span style="color: #008000;">'Pd'</span>, <span style="color: #008000;">'fcc'</span>, a=5, cubic=<span style="color: #D0372D;">True</span>)
bulk[3]<span style="color: #BA36A5;">.symbol</span> = <span style="color: #008000;">'Cu'</span>

<span style="color: #BA36A5;">gen</span> = SlabGenerator(
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   bulk,
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   miller_index=(3, 2, 1),
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   layers=13,
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   vacuum=5)

<span style="color: #BA36A5;">atoms</span> = gen.get_slab(size=1)

<span style="color: #BA36A5;">sites</span> = AdsorptionSites(atoms)

<span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Positon of each site</span>
<span style="color: #BA36A5;">coordinates</span> = sites.get_coordinates()

<span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Number of adjacent surface atoms</span>
<span style="color: #BA36A5;">connectivity</span> = sites.get_connectivity()

<span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">The indices of adjacent surface atoms</span>
<span style="color: #BA36A5;">topology</span> = sites.get_topology()

<span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Only print every 5th entry.</span>
<span style="color: #0000FF;">print</span>(<span style="color: #008000;">'Coordinates:\n'</span>, coordinates[::5], <span style="color: #008000;">'\n'</span>)
<span style="color: #0000FF;">print</span>(<span style="color: #008000;">'Connectivity:\n'</span>, connectivity[::5], <span style="color: #008000;">'\n'</span>)
<span style="color: #0000FF;">print</span>(<span style="color: #008000;">'Topology:\n'</span>, topology[::5], <span style="color: #008000;">'\n'</span>)

<span style="color: #BA36A5;">periodic</span> = sites.get_periodic_sites()
<span style="color: #0000FF;">print</span>(<span style="color: #008000;">'Sites by periodicity:\n'</span>, periodic[::5], <span style="color: #008000;">'\n'</span>)

<span style="color: #BA36A5;">symmetric</span> = sites.get_symmetric_sites()
<span style="color: #0000FF;">print</span>(<span style="color: #008000;">'Sites by symmetry:\n'</span>, symmetric[::5])

<span style="color: #BA36A5;">atm</span> = {1: <span style="color: #008000;">'X'</span>, 2: <span style="color: #008000;">'He'</span>, 3: <span style="color: #008000;">'F'</span>, 4: <span style="color: #008000;">'N'</span>}
<span style="color: #0000FF;">for</span> i, c <span style="color: #0000FF;">in</span> <span style="color: #006FE0;">enumerate</span>(coordinates):
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">typ</span> = connectivity[i]
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">atoms</span> += Atom(atm[typ], c + [0, 0, 2])

atoms.edit()
</pre>
</div>

<p>
Coordinates:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">x</th>
<th scope="col" class="org-right">y</th>
<th scope="col" class="org-right">z</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">2.236</td>
<td class="org-right">0.598</td>
<td class="org-right">11.682</td>
</tr>

<tr>
<td class="org-right">0.559</td>
<td class="org-right">6.126</td>
<td class="org-right">12.684</td>
</tr>

<tr>
<td class="org-right">8.944</td>
<td class="org-right">6.873</td>
<td class="org-right">11.682</td>
</tr>

<tr>
<td class="org-right">1.118</td>
<td class="org-right">7.769</td>
<td class="org-right">12.35</td>
</tr>

<tr>
<td class="org-right">2.795</td>
<td class="org-right">5.229</td>
<td class="org-right">12.016</td>
</tr>

<tr>
<td class="org-right">5.031</td>
<td class="org-right">4.333</td>
<td class="org-right">11.347</td>
</tr>

<tr>
<td class="org-right">7.267</td>
<td class="org-right">1.942</td>
<td class="org-right">12.684</td>
</tr>

<tr>
<td class="org-right">6.336</td>
<td class="org-right">6.673</td>
<td class="org-right">11.013</td>
</tr>

<tr>
<td class="org-right">1.863</td>
<td class="org-right">2.49</td>
<td class="org-right">11.013</td>
</tr>

<tr>
<td class="org-right">8.572</td>
<td class="org-right">4.283</td>
<td class="org-right">12.35</td>
</tr>

<tr>
<td class="org-right">7.826</td>
<td class="org-right">0.598</td>
<td class="org-right">11.682</td>
</tr>
</tbody>
</table>

<p>
Connectivity:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">2</td>
<td class="org-right">2</td>
<td class="org-right">2</td>
<td class="org-right">2</td>
<td class="org-right">2</td>
<td class="org-right">2</td>
<td class="org-right">3</td>
<td class="org-right">3</td>
<td class="org-right">3</td>
<td class="org-right">4</td>
</tr>
</tbody>
</table>

<p>
Topology:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">[16]</td>
</tr>

<tr>
<td class="org-left">[21]</td>
</tr>

<tr>
<td class="org-left">[23, 25]</td>
</tr>

<tr>
<td class="org-left">[18, 23]</td>
</tr>

<tr>
<td class="org-left">[25, 21]</td>
</tr>

<tr>
<td class="org-left">[19, 25]</td>
</tr>

<tr>
<td class="org-left">[19, 20]</td>
</tr>

<tr>
<td class="org-left">[22, 24]</td>
</tr>

<tr>
<td class="org-left">[20, 18, 17]</td>
</tr>

<tr>
<td class="org-left">[21, 19, 16]</td>
</tr>

<tr>
<td class="org-left">[20, 24, 23]</td>
</tr>

<tr>
<td class="org-left">[17, 24, 18, 22]</td>
</tr>
</tbody>
</table>

<p>
Sites by periodicity:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">40</td>
<td class="org-right">45</td>
<td class="org-right">203</td>
<td class="org-right">242</td>
<td class="org-right">250</td>
<td class="org-right">282</td>
<td class="org-right">287</td>
<td class="org-right">294</td>
<td class="org-right">389</td>
<td class="org-right">409</td>
<td class="org-right">415</td>
<td class="org-right">451</td>
</tr>
</tbody>
</table>

<p>
Sites by symmetry:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">40</td>
<td class="org-right">45</td>
<td class="org-right">203</td>
<td class="org-right">242</td>
<td class="org-right">250</td>
<td class="org-right">282</td>
<td class="org-right">287</td>
<td class="org-right">294</td>
<td class="org-right">389</td>
<td class="org-right">409</td>
<td class="org-right">415</td>
<td class="org-right">451</td>
</tr>
</tbody>
</table>

<p>
When we call <code>get_periodic_sites()</code>, we see that some indices are repeated. This is to indicate that these sites are identical in the context of periodic boundaries. If we set <code>screen</code> to True, we will only be given the sites within the original unit cell (between 0-1 in fractional coordinates) and all indices will be unique.
</p>

<p>
In this case there are no symmetrically reducible sites, so <code>get_symmetric_sites()</code> returns the same result.
</p>

<p>
NOTE: The indices of the periodic and symmetry site functions are in reference to the extended unit cell.
</p>
</div>
</div>

<div id="outline-container-orge7728b9" class="outline-4">
<h4 id="orge7728b9"><span class="section-number-4">1.2.3</span> Adsorption vectors</h4>
<div class="outline-text-4" id="text-1-2-3">
<p>
The most commonly studied miller indices, such as fcc(111), produce a flat surface. This means the most favorable angle of adsorption will always be perpendicular to the surface. This is not always the case for higher miller indices. 
</p>

<p>
CatGen defines the most favorable vector for adsorption as the one which is furthest from all neighboring surface atoms. This vector is important for the generation of sensible 3D structures from graph enumerations. This is particularly true for adsorbates with multiple atoms.
</p>


<div class="figure">
<p><img src="../adsorption-vectors.png" alt="adsorption-vectors.png" />
</p>
<p><span class="figure-number">Figure 5: </span>Illustration of adsorption vectors (red dots) on a CuPd<sub>3</sub> (211) surface.</p>
</div>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #0000FF;">from</span> catkit.gen.adsorption <span style="color: #0000FF;">import</span> AdsorptionSites
<span style="color: #0000FF;">from</span> catkit.gen.surface <span style="color: #0000FF;">import</span> SlabGenerator
<span style="color: #0000FF;">from</span> ase.build <span style="color: #0000FF;">import</span> bulk
<span style="color: #0000FF;">from</span> ase <span style="color: #0000FF;">import</span> Atom
<span style="color: #0000FF;">import</span> numpy <span style="color: #0000FF;">as</span> np

<span style="color: #BA36A5;">bulk</span> = bulk(<span style="color: #008000;">'Pd'</span>, <span style="color: #008000;">'fcc'</span>, a=5, cubic=<span style="color: #D0372D;">True</span>)
bulk[3]<span style="color: #BA36A5;">.symbol</span> = <span style="color: #008000;">'Cu'</span>

<span style="color: #BA36A5;">gen</span> = SlabGenerator(
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   bulk,
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   miller_index=(2, 1, 1),
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   layers=10,
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   vacuum=5)

<span style="color: #BA36A5;">atoms</span> = gen.get_slab()
<span style="color: #BA36A5;">sites</span> = AdsorptionSites(atoms)

<span style="color: #BA36A5;">coordinates</span> = sites.get_coordinates()
<span style="color: #BA36A5;">vectors</span> = sites.get_adsorption_vectors()

<span style="color: #BA36A5;">heights</span> = np.arange(0, 2, 0.25)
<span style="color: #0000FF;">for</span> i, c <span style="color: #0000FF;">in</span> <span style="color: #006FE0;">enumerate</span>(coordinates):
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">for</span> h <span style="color: #0000FF;">in</span> heights:
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">atoms</span> += Atom(<span style="color: #008000;">'X'</span>, c + vectors[i] * h)

atoms.wrap()
atoms.edit()
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd415e03" class="outline-4">
<h4 id="orgd415e03"><span class="section-number-4">1.2.4</span> Adsorption structure builder</h4>
<div class="outline-text-4" id="text-1-2-4">
<p>
Creating good initial guesses for 3D structures can be tedious to perform by hand, even for small molecules. The <code>Builder</code> module in the adsorption package seeks to help automate this task.
</p>

<p>
The <code>Builder</code> module currently takes Gratoms objects as input <span class="underline">only</span> since graph information is required. 
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #0000FF;">from</span> catkit.gen.surface <span style="color: #0000FF;">import</span> SlabGenerator
<span style="color: #0000FF;">from</span> catkit.gen.adsorption <span style="color: #0000FF;">import</span> Builder
<span style="color: #0000FF;">from</span> ase.build <span style="color: #0000FF;">import</span> bulk
<span style="color: #0000FF;">import</span> numpy <span style="color: #0000FF;">as</span> np

<span style="color: #BA36A5;">atoms</span> = bulk(<span style="color: #008000;">'Pd'</span>, <span style="color: #008000;">'fcc'</span>, a=4, cubic=<span style="color: #D0372D;">True</span>)
atoms[3]<span style="color: #BA36A5;">.symbol</span> = <span style="color: #008000;">'Cu'</span>

<span style="color: #BA36A5;">gen</span> = SlabGenerator(
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   atoms,
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   miller_index=(1, 1, 1),
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   layers=4,
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   fixed=2,
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   vacuum=10)

<span style="color: #BA36A5;">slab</span> = gen.get_slab()

<span style="color: #BA36A5;">builder</span> = Builder(slab)
<span style="color: #0000FF;">print</span>(builder)
</pre>
</div>

<pre class="example">
Adsorption builder for Cu4Pd12 slab.
unique adsorption sites: 9
site connectivity: [1 1 2 2 2 3 3 3 3]
unique adsorption edges: 21

</pre>
</div>

<ol class="org-ol">
<li><a id="orgec911e7"></a>Monodentate adsorption<br />
<div class="outline-text-5" id="text-1-2-4-1">
<p>
When a single atom of the molecule is considered bonded to the surface, the builder attempts to arrange non-bonded atoms in an intelligent fashion.
</p>

<p>
In this example, the use of <code>-1</code> as a tag on the adsorbate is used to indicate it is bonded to the slab.
</p>

<p>
<img src="../CH3-ads.png" alt="CH3-ads.png" /> <img src="../CH3-ads-top.png" alt="CH3-ads-top.png" />
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #0000FF;">from</span> catkit.build <span style="color: #0000FF;">import</span> molecule
<span style="color: #0000FF;">from</span> catkit.gen.surface <span style="color: #0000FF;">import</span> SlabGenerator
<span style="color: #0000FF;">from</span> catkit.gen.adsorption <span style="color: #0000FF;">import</span> Builder
<span style="color: #0000FF;">from</span> ase.build <span style="color: #0000FF;">import</span> bulk

<span style="color: #BA36A5;">atoms</span> = bulk(<span style="color: #008000;">'Pd'</span>, <span style="color: #008000;">'fcc'</span>, a=4, cubic=<span style="color: #D0372D;">True</span>)
atoms[3]<span style="color: #BA36A5;">.symbol</span> = <span style="color: #008000;">'Cu'</span>

<span style="color: #BA36A5;">gen</span> = SlabGenerator(
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   atoms,
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   miller_index=(1, 1, 1),
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   layers=4,
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   vacuum=4)

<span style="color: #BA36A5;">slab</span> = gen.get_slab()

<span style="color: #BA36A5;">adsorbate</span> = molecule(<span style="color: #008000;">'CH3'</span>)[0]
adsorbate.set_tags([-1, 0, 0, 0])

<span style="color: #BA36A5;">builder</span> = Builder(slab)
<span style="color: #BA36A5;">ads_slab</span> = builder.add_adsorbate(adsorbate, index=0)

ads_slab.edit()
</pre>
</div>
</div>
</li>

<li><a id="org5f5c064"></a>Bidentate adsorption<br />
<div class="outline-text-5" id="text-1-2-4-2">
<p>
The <code>Builder</code> class can also produce structures for species bonded in two locations. In this example, indexing of the atoms which bond to the surface is done with the <code>bonds</code> key.
</p>

<p>
Also, using setting the <code>index</code> key to <code>-1</code> will return a list of all the possible adsorbed structures.
</p>

<p>
<img src="../CH2CH-ads.png" alt="CH2CH-ads.png" /> <img src="../CH2CH-ads-top.png" alt="CH2CH-ads-top.png" />
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #0000FF;">from</span> catkit.build <span style="color: #0000FF;">import</span> molecule
<span style="color: #0000FF;">from</span> catkit.gen.surface <span style="color: #0000FF;">import</span> SlabGenerator
<span style="color: #0000FF;">from</span> catkit.gen.adsorption <span style="color: #0000FF;">import</span> Builder
<span style="color: #0000FF;">from</span> ase.build <span style="color: #0000FF;">import</span> bulk
<span style="color: #0000FF;">from</span> ase.visualize <span style="color: #0000FF;">import</span> view

<span style="color: #BA36A5;">atoms</span> = bulk(<span style="color: #008000;">'Pd'</span>, <span style="color: #008000;">'fcc'</span>, a=4, cubic=<span style="color: #D0372D;">True</span>)
atoms[3]<span style="color: #BA36A5;">.symbol</span> = <span style="color: #008000;">'Cu'</span>

<span style="color: #BA36A5;">gen</span> = SlabGenerator(
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   atoms,
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   miller_index=(1, 1, 1),
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   layers=4,
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   vacuum=4)

<span style="color: #BA36A5;">slab</span> = gen.get_slab()
<span style="color: #BA36A5;">adsorbate</span> = molecule(<span style="color: #008000;">'C2H3'</span>)[1]

<span style="color: #BA36A5;">builder</span> = Builder(slab)
<span style="color: #BA36A5;">ads_slab</span> = builder.add_adsorbate(adsorbate, bonds=[0, 1], index=-1)

<span style="color: #0000FF;">print</span>(<span style="color: #008000;">'{} adsorption structures generated'</span>.<span style="color: #006FE0;">format</span>(<span style="color: #006FE0;">len</span>(ads_slab)))

view(ads_slab)
</pre>
</div>
</div>
</li>
</ol>
</div>
</div>

<div id="outline-container-org24eeb02" class="outline-3">
<h3 id="org24eeb02"><span class="section-number-3">1.3</span> Gas-phase:</h3>
<div class="outline-text-3" id="text-1-3">
<ul class="org-ul">
<li class="on"><code>[X]</code> Various chemical species (C, H, and O currently tested)</li>
<li class="on"><code>[X]</code> Molecules with single bonds</li>
<li class="on"><code>[X]</code> Molecules with double bonds</li>
<li class="on"><code>[X]</code> Molecules with triple bonds</li>
<li class="on"><code>[X]</code> Molecules with single cyclical groups</li>
<li class="on"><code>[X]</code> Molecules with double cyclical groups</li>
<li class="on"><code>[X]</code> Molecules with triple cyclical groups</li>
<li class="on"><code>[X]</code> UFF 3D structure predictions</li>
</ul>
</div>

<div id="outline-container-orgb177929" class="outline-4">
<h4 id="orgb177929"><span class="section-number-4">1.3.1</span> Example usage:</h4>
<div class="outline-text-4" id="text-1-3-1">
<p>
Below is an example script which generates some simple figures using <a href="https://networkx.github.io/documentation/networkx-1.10/index.html">NetworkX</a> code for all molecules up to C<sub>2</sub>H<sub>6</sub>.
</p>

<p>
<img src="../molecule-1.png" alt="molecule-1.png" /> <img src="../molecule-2.png" alt="molecule-2.png" /> <img src="../molecule-3.png" alt="molecule-3.png" /> <img src="../molecule-4.png" alt="molecule-4.png" /> 
<img src="../molecule-5.png" alt="molecule-5.png" /> <img src="../molecule-6.png" alt="molecule-6.png" /> <img src="../molecule-7.png" alt="molecule-7.png" /> <img src="../molecule-8.png" alt="molecule-8.png" />
<img src="../molecule-9.png" alt="molecule-9.png" /> <img src="../molecule-10.png" alt="molecule-10.png" /> <img src="../molecule-11.png" alt="molecule-11.png" /> <img src="../molecule-12.png" alt="molecule-12.png" />
<img src="../molecule-13.png" alt="molecule-13.png" /> <img src="../molecule-14.png" alt="molecule-14.png" /> <img src="../molecule-15.png" alt="molecule-15.png" /> <img src="../molecule-16.png" alt="molecule-16.png" />
<img src="../molecule-17.png" alt="molecule-17.png" />
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #0000FF;">from</span> catkit.gen.pathways <span style="color: #0000FF;">import</span> ReactionNetwork
<span style="color: #0000FF;">import</span> time

<span style="color: #BA36A5;">start</span> = time.time()

<span style="color: #BA36A5;">db_name</span> = <span style="color: #008000;">'C2H6-example.db'</span>
<span style="color: #0000FF;">with</span> ReactionNetwork(db_name=db_name) <span style="color: #0000FF;">as</span> rn:

<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Run a molecule search</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   rn.molecule_search(
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   element_pool={<span style="color: #008000;">'C'</span>: 2, <span style="color: #008000;">'H'</span>: 6},
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   multiple_bond_search=<span style="color: #D0372D;">False</span>)

<span style="color: #0000FF;">print</span>(<span style="color: #008000;">'Process completed in {:.1f}s'</span>.<span style="color: #006FE0;">format</span>(time.time() - start))
</pre>
</div>

<pre class="example">
Process completed in 0.0s

</pre>
</div>
</div>
</div>

<div id="outline-container-orgf0caef0" class="outline-3">
<h3 id="orgf0caef0"><span class="section-number-3">1.4</span> Reaction mechanisms:</h3>
<div class="outline-text-3" id="text-1-4">
<ul class="org-ul">
<li class="on"><code>[X]</code> Addition and Reduction reactions (R1 + R2 &lt;&#x2013;&gt; P1)</li>
<li class="on"><code>[X]</code> Bond formation / breaking pathways (R1 &lt;&#x2013;&gt; P1)</li>
<li class="on"><code>[X]</code> Reconfiguration reactions (R1 &lt;&#x2013;&gt; R1*)</li>
<li class="on"><code>[X]</code> Substitution reactions (R1 + R2 &lt;&#x2013;&gt; P1 + P2)</li>
</ul>
</div>

<div id="outline-container-org3cd1734" class="outline-4">
<h4 id="org3cd1734"><span class="section-number-4">1.4.1</span> Reaction networks:</h4>
<div class="outline-text-4" id="text-1-4-1">
<p>
Enumeration of possible elementary reaction steps for gas-phase C<sub>2</sub>H<sub>6</sub> species.
</p>


<div class="figure">
<p><img src="../reaction-network.png" alt="reaction-network.png" />
</p>
<p><span class="figure-number">Figure 6: </span>Reaction network for C2H6 gas phase molecules. Numbers are indexes from the gas-phase example figures.</p>
</div>

<p>
Pathway exploration is currently integrated with gas-phase molecule search. See the gas-phase molecule search example for further details on molecule generations. Below, a reaction network is generated.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #0000FF;">from</span> catkit.gen.pathways <span style="color: #0000FF;">import</span> ReactionNetwork
<span style="color: #0000FF;">import</span> time

<span style="color: #BA36A5;">start</span> = time.time()

<span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Load existing database</span>
<span style="color: #BA36A5;">db_name</span> = <span style="color: #008000;">'C2H6-example.db'</span>

<span style="color: #0000FF;">with</span> ReactionNetwork(db_name=db_name) <span style="color: #0000FF;">as</span> rn:
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Substitution pathway search is expensive!</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   rn.path_search(
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   reconfiguration=<span style="color: #D0372D;">False</span>,
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   substitution=<span style="color: #D0372D;">False</span>)

<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   rn.plot_reaction_network(file_name=<span style="color: #008000;">'../reaction-network.png'</span>)

<span style="color: #0000FF;">print</span>(<span style="color: #008000;">'Process completed in {:.1f}s'</span>.<span style="color: #006FE0;">format</span>(time.time() - start))
</pre>
</div>

<pre class="example">
Process completed in 0.3s

</pre>

<p>
Once the reaction network has been produce, we can illustrate the potential pathways using the following code.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #0000FF;">from</span> catkit.gen.pathways <span style="color: #0000FF;">import</span> ReactionNetwork
<span style="color: #0000FF;">import</span> numpy <span style="color: #0000FF;">as</span> np
<span style="color: #0000FF;">import</span> networkx <span style="color: #0000FF;">as</span> nx
<span style="color: #0000FF;">from</span> ase.utils <span style="color: #0000FF;">import</span> formula_hill

<span style="color: #0000FF;">with</span> ReactionNetwork(db_name=<span style="color: #008000;">'C2H6-example.db'</span>) <span style="color: #0000FF;">as</span> rn:
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">molecules</span> = rn.load_molecules()
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">pathways</span> = rn.load_pathways()

<span style="color: #BA36A5;">names</span> = np.empty(<span style="color: #006FE0;">len</span>(molecules) + 1, dtype=<span style="color: #008000;">'a5'</span>)

<span style="color: #0000FF;">for</span> k, v <span style="color: #0000FF;">in</span> molecules.items():
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">atn</span> = nx.get_node_attributes(v.graph, <span style="color: #008000;">'number'</span>)

<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">These are not always unique identifiers</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">hill</span> = formula_hill(<span style="color: #006FE0;">list</span>(atn.values()))
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">names</span>[k] = hill

<span style="color: #0000FF;">print</span>(<span style="color: #008000;">'|Reactants|Products|'</span>)
<span style="color: #0000FF;">print</span>(<span style="color: #008000;">'|-'</span>)
<span style="color: #0000FF;">for</span> path <span style="color: #0000FF;">in</span> pathways:
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">print</span>(<span style="color: #008000;">'|{} + {} | {} |'</span>.<span style="color: #006FE0;">format</span>(
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   names[path][0].decode(<span style="color: #008000;">"utf-8"</span>),
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   names[path][1].decode(<span style="color: #008000;">"utf-8"</span>),
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   names[path][3].decode(<span style="color: #008000;">"utf-8"</span>)))
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Reactants</th>
<th scope="col" class="org-left">Products</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">H + H</td>
<td class="org-left">H2</td>
</tr>

<tr>
<td class="org-left">H + C</td>
<td class="org-left">CH</td>
</tr>

<tr>
<td class="org-left">H + CH</td>
<td class="org-left">CH2</td>
</tr>

<tr>
<td class="org-left">H + C2</td>
<td class="org-left">C2H</td>
</tr>

<tr>
<td class="org-left">H + CH2</td>
<td class="org-left">CH3</td>
</tr>

<tr>
<td class="org-left">H + C2H</td>
<td class="org-left">C2H2</td>
</tr>

<tr>
<td class="org-left">H + C2H</td>
<td class="org-left">C2H2</td>
</tr>

<tr>
<td class="org-left">H + CH3</td>
<td class="org-left">CH4</td>
</tr>

<tr>
<td class="org-left">H + C2H2</td>
<td class="org-left">C2H3</td>
</tr>

<tr>
<td class="org-left">H + C2H2</td>
<td class="org-left">C2H3</td>
</tr>

<tr>
<td class="org-left">H + C2H2</td>
<td class="org-left">C2H3</td>
</tr>

<tr>
<td class="org-left">H + C2H3</td>
<td class="org-left">C2H4</td>
</tr>

<tr>
<td class="org-left">H + C2H3</td>
<td class="org-left">C2H4</td>
</tr>

<tr>
<td class="org-left">H + C2H3</td>
<td class="org-left">C2H4</td>
</tr>

<tr>
<td class="org-left">H + C2H4</td>
<td class="org-left">C2H5</td>
</tr>

<tr>
<td class="org-left">H + C2H4</td>
<td class="org-left">C2H5</td>
</tr>

<tr>
<td class="org-left">H + C2H5</td>
<td class="org-left">C2H6</td>
</tr>

<tr>
<td class="org-left">C + C</td>
<td class="org-left">C2</td>
</tr>

<tr>
<td class="org-left">C + CH</td>
<td class="org-left">C2H</td>
</tr>

<tr>
<td class="org-left">C + CH2</td>
<td class="org-left">C2H2</td>
</tr>

<tr>
<td class="org-left">C + CH3</td>
<td class="org-left">C2H3</td>
</tr>

<tr>
<td class="org-left">CH + CH</td>
<td class="org-left">C2H2</td>
</tr>

<tr>
<td class="org-left">CH + CH2</td>
<td class="org-left">C2H3</td>
</tr>

<tr>
<td class="org-left">CH + CH3</td>
<td class="org-left">C2H4</td>
</tr>

<tr>
<td class="org-left">CH2 + CH2</td>
<td class="org-left">C2H4</td>
</tr>

<tr>
<td class="org-left">CH2 + CH3</td>
<td class="org-left">C2H5</td>
</tr>

<tr>
<td class="org-left">CH3 + CH3</td>
<td class="org-left">C2H6</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

<div id="outline-container-org50cf3ef" class="outline-3">
<h3 id="org50cf3ef"><span class="section-number-3">1.5</span> Reaction routes</h3>
<div class="outline-text-3" id="text-1-5">
<ul class="org-ul">
<li class="on"><code>[X]</code> Overall/Response reaction routes</li>
<li class="on"><code>[X]</code> Linearly independent set of reaction routes</li>
<li class="on"><code>[X]</code> Complete set of full reaction routes</li>
<li class="on"><code>[X]</code> Complete set of empty reaction routes</li>
<li class="off"><code>[&#xa0;]</code> Graph based enumeration</li>
</ul>
</div>

<div id="outline-container-org1f6c48b" class="outline-4">
<h4 id="org1f6c48b"><span class="section-number-4">1.5.1</span> Overall/Response reaction routes</h4>
<div class="outline-text-4" id="text-1-5-1">
<p>
For a given set of elementary mechanisms, there is frequently many types of chemistry which could be considered simultaneously. As an example, we reproduce an example from the original literature which the algorithm is adopted from <a class='org-ref-reference' href="#fishtik-2004-new-approac">fishtik-2004-new-approac</a>.
</p>

<p>
In this example, we choose the number of independent species.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #0000FF;">from</span> catkit.gen.route <span style="color: #0000FF;">import</span> get_response_reactions
<span style="color: #0000FF;">import</span> numpy <span style="color: #0000FF;">as</span> np

<span style="color: #BA36A5;">epsilon</span> = np.array([
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">To keep indexing consistent</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [ 0, 0, 0, 0],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">I1</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [ 0, 0, 0, 0],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">I2</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [ 0, 0, 0, 0],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">I3</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [ 0, 0, 0, 0],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">I4</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [ 0, 0, 0, 0],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">I5</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">C  N  H  O</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [ 1, 0, 4, 0],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">CH4</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [ 0, 1, 0, 1],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">NO</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [ 0, 0, 0, 2],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">O2</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [ 0, 2, 0, 0],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">N2</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [ 1, 0, 0, 1],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">CO</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [ 1, 0, 0, 2],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">CO2</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [ 0, 0, 2, 1],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">H2O</span>
])

<span style="color: #BA36A5;">terminal</span> = [5, 6, 7, 8, 9, 10, 11]
<span style="color: #BA36A5;">OR</span>, <span style="color: #BA36A5;">species</span> = get_response_reactions(epsilon, terminal, species=<span style="color: #D0372D;">True</span>)

<span style="color: #0000FF;">print</span>(<span style="color: #008000;">'Overall reaction routes:'</span>)
<span style="color: #0000FF;">print</span>(OR, <span style="color: #008000;">'\n'</span>)

<span style="color: #0000FF;">print</span>(<span style="color: #008000;">'Terminal species:'</span>)
<span style="color: #0000FF;">print</span>(species)
</pre>
</div>

<pre class="example">
Overall reaction routes:
[[ 0  0  0  0  0  0  2 -1 -1  0  0  0]
 [ 0  0  0  0  0  0  0  1  0  2 -2  0]
 [ 0  0  0  0  0  2  0  3  0 -2  0 -4]
 [ 0  0  0  0  0  1  0  2  0  0 -1 -2]
 [ 0  0  0  0  0  0  2  0 -1  2 -2  0]
 [ 0  0  0  0  0  2  6  0 -3 -2  0 -4]
 [ 0  0  0  0  0  1  4  0 -2  0 -1 -2]
 [ 0  0  0  0  0  1  0  0  0 -4  3 -2]] 

Terminal species:
[[ 5  6  7  8  9]
 [ 5  6  7  9 10]
 [ 5  6  7  9 11]
 [ 5  6  7 10 11]
 [ 5  6  8  9 10]
 [ 5  6  8  9 11]
 [ 5  6  8 10 11]
 [ 5  6  9 10 11]]
</pre>

<p>
The terminal species matrix will always contain <code>s + 1</code> entries, where <code>s</code> is the number of elements in the chemistry. This does not necessarily mean that the overall reaction produced will include all <code>s + 1</code> species.
</p>
</div>
</div>

<div id="outline-container-org2e49186" class="outline-4">
<h4 id="org2e49186"><span class="section-number-4">1.5.2</span> Linearly independent set</h4>
<div class="outline-text-4" id="text-1-5-2">
<p>
Currently, only Happel-Sellers reaction routes can be enumerated <a class='org-ref-reference' href="#fishtik-2004-new-approac">fishtik-2004-new-approac</a>. These routes require that the user choose a number of terminal species equal to <code>s + 1</code>. The terminal species selected will only produce overall reactions associated with the chemistry which is enumerated in the previous example.
</p>

<p>
Below we take another example from to produce a linearly independent set of reaction routes <a class='org-ref-reference' href="#fishtik-2004-react-route-graph-2">fishtik-2004-react-route-graph-2</a>.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #0000FF;">from</span> catkit.gen.route <span style="color: #0000FF;">import</span> get_response_reactions
<span style="color: #0000FF;">from</span> catkit.gen.route <span style="color: #0000FF;">import</span> get_heppel_sellers
<span style="color: #0000FF;">import</span> numpy <span style="color: #0000FF;">as</span> np

<span style="color: #BA36A5;">nu</span> = np.array([
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">H2Os, COs, CO2s, H2s, Hs, OHs, Os, HCOOs, H2O, CO, CO2, H2</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [   0,   1,   0,   0,   0,   0,   0,   0,   0,  -1,   0,   0],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">s1</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [   1,   0,   0,   0,   0,   0,   0,   0,  -1,   0,   0,   0],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">s2</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [   0,   0,  -1,   0,   0,   0,   0,   0,   0,   0,   1,   0],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">s3</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [   0,   0,   0,   1,  -2,   0,   0,   0,   0,   0,   0,   0],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">s4</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [   0,   0,   0,  -1,   0,   0,   0,   0,   0,   0,   0,   1],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">s5</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [  -1,   0,   0,   0,   1,   1,   0,   0,   0,   0,   0,   0],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">s6</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [   0,  -1 ,  1,   0,   0,   0,  -1,   0,   0,   0,   0,   0],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">s7</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [   0,  -1,   0,   0,   0,  -1,   0,   1,   0,   0,   0,   0],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">s8</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [   0,   0,   0,   0,   1,  -1,   1,   0,   0,   0,   0,   0],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">s9</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [   0,  -1,   1,   0,   1,  -1,   0,   0,   0,   0,   0,   0],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">s10</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [   0,   0,   1,   0,   1,   0,   0,  -1,   0,   0,   0,   0],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">s11</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [   0,   0,   1,   0,   0,   1,  -1,  -1,   0,   0,   0,   0],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">s12</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [  -1,   0,   0,   1,  -1,   1,   0,   0,   0,   0,   0,   0],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">s14</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [   0,   0,   0,   1,  -1,  -1,   1,   0,   0,   0,   0,   0],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">s15</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [   0,   0,   1,   1,  -1,   0,   0,  -1,   0,   0,   0,   0],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">s17</span>
])

<span style="color: #BA36A5;">epsilon</span> = np.array([
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Just a place holder</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [ 0, 0, 0],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">H2OS</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [ 0, 0, 0],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">COS</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [ 0, 0, 0],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">CO2S</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [ 0, 0, 0],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">H2S</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [ 0, 0, 0],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">HS</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [ 0, 0, 0],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">OHS</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [ 0, 0, 0],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">OS</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [ 0, 0, 0],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">HCOOS</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">C, H, O</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [ 0, 2, 1],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">H2O</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [ 1, 0, 1],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">CO</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [ 1, 0, 2],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">CO2</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [ 0, 2, 0],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">H2</span>
])

<span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Indices of the terminal species</span>
<span style="color: #BA36A5;">terminal</span> = [8, 9, 10, 11]

<span style="color: #BA36A5;">RER</span>, <span style="color: #BA36A5;">species</span> = get_response_reactions(epsilon, terminal, species=<span style="color: #D0372D;">True</span>)
<span style="color: #BA36A5;">sigma</span> = get_heppel_sellers(nu, species[0])

<span style="color: #0000FF;">print</span>(<span style="color: #008000;">'Linearly independent set of reaction routes:'</span>)
<span style="color: #0000FF;">print</span>(sigma, <span style="color: #008000;">'\n'</span>)

<span style="color: #0000FF;">print</span>(<span style="color: #008000;">'Overall reaction routes:'</span>)
<span style="color: #0000FF;">print</span>(np.dot(sigma, nu))
</pre>
</div>

<pre class="example">
Linearly independent set of reaction routes:
[[ 1  1  1  1  1  1  1  0  1  0  0  0  0  0  0]
 [ 1  1  1  1  1  1  0  0  0  1  0  0  0  0  0]
 [ 1  1  1  1  1  1  0  1  0  0  1  0  0  0  0]
 [ 0  0  0  0  0  0  1 -1  0  0  0 -1  0  0  0]
 [ 0  0  0  1  0  1  0  0  0  0  0  0 -1  0  0]
 [ 1  1  1  0  1  1  1  0  0  0  0  0  0  1  0]
 [ 1  1  1  0  1  1  0  1  0  0  0  0  0  0  1]] 

Overall reaction routes:
[[ 0  0  0  0  0  0  0  0 -1 -1  1  1]
 [ 0  0  0  0  0  0  0  0 -1 -1  1  1]
 [ 0  0  0  0  0  0  0  0 -1 -1  1  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 -1 -1  1  1]
 [ 0  0  0  0  0  0  0  0 -1 -1  1  1]]
</pre>

<p>
Note that all of the linearly independent reaction routes return the same overall reaction except for one. This is because some routes will return a trivial solution. Routes which return the correct overall chemistry are known as full routes (FR) and those which return trivial solutions are called empty routes (ER).
</p>
</div>
</div>

<div id="outline-container-orgd52d961" class="outline-4">
<h4 id="orgd52d961"><span class="section-number-4">1.5.3</span> Complete full and empty enumeration</h4>
<div class="outline-text-4" id="text-1-5-3">
<p>
Computationally, collecting an arbitrary set of linearly independent reaction routes is computationally inexpensive and can potentially be useful on its own. Complete enumeration techniques currently implemented in CatGen become computationally infeasible with large numbers of species and elementary steps.
</p>

<p>
However, it is still often desirable for some applications to have a full listing of both full and empty reaction routes. This can be achieved more efficiently when beginning with a linearly independent set of reaction routes <a class='org-ref-reference' href="#fishtik-2002-ubi-qep">fishtik-2002-ubi-qep</a>.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #0000FF;">from</span> catkit.gen.route <span style="color: #0000FF;">import</span> get_response_reactions
<span style="color: #0000FF;">from</span> catkit.gen.route <span style="color: #0000FF;">import</span> get_reaction_routes
<span style="color: #0000FF;">from</span> catkit.gen.route <span style="color: #0000FF;">import</span> get_heppel_sellers
<span style="color: #0000FF;">import</span> numpy <span style="color: #0000FF;">as</span> np
np.set_printoptions(threshold=np.inf)

<span style="color: #BA36A5;">nu</span> = np.array([
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [  1,  0,  0,  0,  0,  0,  0,  0, -1,  0,  0,  0],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">s1</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [  0,  1,  0,  0,  0,  0,  0,  0,  0, -1,  0,  0],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">s2</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  1,  0],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">s3</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [  0,  0,  0,  1, -2,  0,  0,  0,  0,  0,  0,  0],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">s4</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [  0,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  1],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">s5</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [ -1,  0,  0,  0,  1,  1,  0,  0,  0,  0,  0,  0],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">s6</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [  0, -1,  1,  0,  0,  0, -1,  0,  0,  0,  0,  0],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">s7</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [  0, -1,  0,  0,  0, -1,  0,  1,  0,  0,  0,  0],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">s8</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [  0,  0,  0,  0,  1, -1,  1,  0,  0,  0,  0,  0],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">s9</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [  0, -1,  1,  0,  1, -1,  0,  0,  0,  0,  0,  0],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">s10</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [  0,  0,  1,  0,  1,  0,  0, -1,  0,  0,  0,  0],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">s11</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [  0,  0,  1,  0,  0,  1, -1, -1,  0,  0,  0,  0],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">s12</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [ -1,  0,  0,  0,  0,  2, -1,  0,  0,  0,  0,  0],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">s13</span>
])

<span style="color: #BA36A5;">epsilon</span> = np.array([
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">C, H, O</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [ 0, 2, 1],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">SH2O</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [ 1, 0, 1],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">SCO</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [ 1, 0, 2],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">SCO2</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [ 0, 2, 0],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">SH2</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [ 0, 1, 0],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">SH</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [ 0, 1, 1],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">SOH</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [ 0, 0, 1],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">SO</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [ 1, 1, 2],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">SOOCH</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [ 0, 2, 1],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">H2O</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [ 1, 0, 1],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">CO</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [ 1, 0, 2],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">CO2</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   [ 0, 2, 0],  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">H2</span>
])


<span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Indices of the species considered terminal</span>
<span style="color: #BA36A5;">terminal</span> = [8, 9, 10, 11]

<span style="color: #BA36A5;">RER</span>, <span style="color: #BA36A5;">species</span> = get_response_reactions(epsilon, terminal, species=<span style="color: #D0372D;">True</span>)
<span style="color: #BA36A5;">sigma</span> = get_heppel_sellers(nu, species[0])
<span style="color: #BA36A5;">FR</span>, <span style="color: #BA36A5;">ER</span> = get_reaction_routes(nu, sigma)

<span style="color: #0000FF;">print</span>(<span style="color: #008000;">'{} Full reaction routes:'</span>.<span style="color: #006FE0;">format</span>(<span style="color: #006FE0;">len</span>(FR)))
<span style="color: #0000FF;">print</span>(FR, <span style="color: #008000;">'\n'</span>)

<span style="color: #0000FF;">print</span>(<span style="color: #008000;">'{} Empty reaction routes:'</span>.<span style="color: #006FE0;">format</span>(<span style="color: #006FE0;">len</span>(ER)))
<span style="color: #0000FF;">print</span>(ER)
</pre>
</div>

<pre class="example">
17 Full reaction routes:
[[ 1  1  1  1  1  1  1  0  1  0  0  0  0]
 [ 1  1  1  1  1  1  0  0  0  1  0  0  0]
 [ 1  1  1  1  1  1  0  1  0  0  1  0  0]
 [ 1  1  1  1  1  2  1  0  0  0  0  0 -1]
 [ 1  1  1  1  1  0  0  0  0  1  1 -1  1]
 [ 1  1  1  1  1  0  0  0  1  1  0  0  1]
 [ 1  1  1  1  1  0  0  1  0  0  2 -1  1]
 [ 1  1  1  1  1  0  0 -1  0  2  0 -1  1]
 [ 1  1  1  1  1  0  0  1  2  0  0  1  1]
 [ 1  1  1  1  1  0  0  1  1  0  1  0  1]
 [ 1  1  1  1  1  0  1  0  0  0  2 -2  1]
 [ 1  1  1  1  1  0 -1  0  0  2  0  0  1]
 [ 1  1  1  1  1  0  1  0  2  0  0  0  1]
 [ 1  1  1  1  1  0 -1  2  0  0  2  0  1]
 [ 1  1  1  1  1  2  0  1  0  0  0  1 -1]
 [ 1  1  1  1  1  1  0  1  1  0  0  1  0]
 [ 1  1  1  1  1  1  1  0  0  0  1 -1  0]] 

12 Empty reaction routes:
[[ 0  0  0  0  0  0  1 -1  0  0  0 -1  0]
 [ 0  0  0  0  0  0  0  0  1  0 -1  1  0]
 [ 0  0  0  0  0  0  0  1  0 -1  1  0  0]
 [ 0  0  0  0  0  0  0  1  1 -1  0  1  0]
 [ 0  0  0  0  0  0  1  0  0 -1  1 -1  0]
 [ 0  0  0  0  0  0  1  0  1 -1  0  0  0]
 [ 0  0  0  0  0  0  1 -1  1  0 -1  0  0]
 [ 0  0  0  0  0  1  0  0  0  0 -1  1 -1]
 [ 0  0  0  0  0  1  0  0 -1  0  0  0 -1]
 [ 0  0  0  0  0  1  0  1  0 -1  0  1 -1]
 [ 0  0  0  0  0  1  1  0  0 -1  0  0 -1]
 [ 0  0  0  0  0  1  1 -1  0  0 -1  0 -1]]
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Jacob Boes</p>
<p class="date">Created: 2018-06-02 Sat 20:10</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
